<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chikitsa Smart | Smart Hospital Queue</title>
    <link rel="icon" href="{{ url_for('static', filename='images/chikitsa-smart-logo.png') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <header class="header">
        <a href="{{ url_for('index') }}" class="logo brand"><img src="{{ url_for('static', filename='images/chikitsa-smart-logo.png') }}" alt="Chikitsa Smart logo"><span>Chikitsa Smart</span></a>
        <nav class="navbar">
            {% if user %}
            <a href="{{ url_for('index') }}">Home</a>
            <a href="{{ url_for('dashboard') }}">Dashboard</a>
            {% if user.role == 'patient' %}
            <a href="{{ url_for('book_appointment') }}">Book</a>
            {% endif %}
            <a href="{{ url_for('helpdesk') }}">Helpdesk</a>
            <a href="{{ url_for('notifications') }}">Notifications</a>
            <a href="{{ url_for('logout') }}">Logout</a>
            {% else %}
            <a href="{{ url_for('index') }}">Home</a>
            <a href="{{ url_for('login') }}">Login</a>
            <a href="{{ url_for('register') }}">Patient Register</a>
            <a href="{{ url_for('doctor_register') }}">Doctor Register</a>
            <a href="{{ url_for('admin_register') }}">Admin Register</a>
            {% endif %}
        </nav>
        <div id="menu-btn" class="fas fa-bars"></div>
    </header>

    <section class="home" id="home">
        <div class="image">
            <img src="{{ url_for('static', filename='images/doctors-animate.svg') }}" alt="Smart Hospital">
        </div>
        <div class="content">
            <h3>Skip the Queue, Not the Care.</h3>
            <p>Transforming government healthcare from “First Come, First Served” to “Care Where It Matters Most”.</p>
            <a href="{{ url_for('register') }}" class="btn-home">Get Started<span class="fas fa-chevron-right"></span></a>
        </div>
    </section>

    <h1 class="heading">Our <span>Services</span></h1>
    <section class="services" id="modules">
        <div class="box-container">
            <div class="glass-box">
                <i class="fas fa-hospital"></i>
                <h3>Admin & Authority Dashboard</h3>
                <p>Central control for hospital flow, alerts, and analytics.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-id-card"></i>
                <h3>Smart Patient Registration</h3>
                <p>Capture priority, language, and demographics in one step.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-calendar-check"></i>
                <h3>Appointment Scheduling</h3>
                <p>Auto-assign the best doctor and smart time slots.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-stream"></i>
                <h3>Dynamic Queue Management</h3>
                <p>Priority-aware queue ordering and live updates.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-user-md"></i>
                <h3>Doctor Availability Tracking</h3>
                <p>Admin + doctor updates with real-time status.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-ambulance"></i>
                <h3>Priority & Emergency Handling</h3>
                <p>Emergency cases bubble to the top automatically.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-ticket-alt"></i>
                <h3>Token & Smart Slot Allocation</h3>
                <p>Instant token generation and wait-time estimation.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-bell"></i>
                <h3>Real-Time Notifications</h3>
                <p>Email + in-app + SMS alerts for every update.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-robot"></i>
                <h3>AI Multilingual Helpdesk</h3>
                <p>Rules-based assistant with API fallback.</p>
            </div>
            <div class="glass-box">
                <i class="fas fa-users"></i>
                <h3>AI Crowd Monitor</h3>
                <p>Live crowd level and capacity insights.</p>
            </div>
        </div>
    </section>

    <div class="chatbot">
        <button class="chatbot-toggle" id="chatbot-toggle">
            <i class="fas fa-comment-medical"></i>
        </button>
        <div class="chatbot-panel" id="chatbot-panel">
            <div class="chatbot-header">
                <span>Chikitsa Smart Assistant</span>
                <button class="chatbot-close" id="chatbot-close">&times;</button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="chatbot-message bot">Hello! I can help with appointments, queue status, and hospital info.</div>
            </div>
            <div class="chatbot-inputs">
                <select id="chatbot-language">
                    <option value="en">English</option>
                    <option value="hi">Hindi</option>
                    <option value="mr">Marathi</option>
                    <option value="ta">Tamil</option>
                    <option value="te">Telugu</option>
                    <option value="bn">Bengali</option>
                    <option value="gu">Gujarati</option>
                    <option value="kn">Kannada</option>
                    <option value="ml">Malayalam</option>
                </select>
                <input type="text" id="chatbot-text" placeholder="Type your message">
                <button class="btn" id="chatbot-send">Send</button>
            </div>
        </div>
    </div>

    <script>
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const chatbotPanel = document.getElementById('chatbot-panel');
        const chatbotClose = document.getElementById('chatbot-close');
        const chatbotSend = document.getElementById('chatbot-send');
        const chatbotText = document.getElementById('chatbot-text');
        const chatbotMessages = document.getElementById('chatbot-messages');
        const chatbotLanguage = document.getElementById('chatbot-language');

        function addMessage(text, type) {
            const div = document.createElement('div');
            div.className = `chatbot-message ${type}`;
            div.textContent = text;
            chatbotMessages.appendChild(div);
            chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
        }

        chatbotToggle.addEventListener('click', () => {
            chatbotPanel.classList.toggle('open');
        });

        chatbotClose.addEventListener('click', () => {
            chatbotPanel.classList.remove('open');
        });

        chatbotSend.addEventListener('click', async () => {
            const text = chatbotText.value.trim();
            if (!text) return;
            addMessage(text, 'user');
            chatbotText.value = '';

            try {
                const response = await fetch('{{ url_for('api_helpdesk_public') }}', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: text, language: chatbotLanguage.value })
                });
                const data = await response.json();
                addMessage(data.reply || 'Thanks for reaching out!', 'bot');
            } catch (err) {
                addMessage('Sorry, I could not connect right now.', 'bot');
            }
        });

        chatbotText.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                chatbotSend.click();
            }
        });
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>
